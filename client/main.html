<head>
  <title>booking</title>
</head>

<body>
  {{> loginButtons }}
</body>

<template name='mainView'>
  <div class='main-view'>
    {{> chat }}
    {{> property }}
  </div>
</template>

<template name='chat'>
  <div class='chat'>
    {{ #each chat }}
      <div class='{{ chatColor this }}'>
        {{msg}}
      </div>
    {{ /each }}
    {{ #if chatLoading }}
      <div class='chat__msg--loading'>...</div>
    {{ /if }}
    <div class='chat__input'>
      <form class='chat__input-form'>
        <div class="input-field">
          <input placeholder='Type a message' id='first_name' name='msg' type='text' class='validate'>
        </div>
      </form>
      {{> login }}
    </div>
  </div>
</template>

<template name='property'>
  <div class='property'>
    <div class='property-card card'>
      <div class='card-image'>
        <img src='http://q-ec.bstatic.com/images/hotel/840x460/544/54463340.jpg'>
        <span class='card-title'>Ascott Makati</span>
        <div class='property-card__actions'>
          <a class='btn light-blue'>Book</a>
          <button id="shareBooking" data-target="modal1" class="btn book-share light-blue modal-trigger {{#unless currentUser}} disabled {{/unless}}">Share Booking</button>
        </div>
      </div>
      <div class='card-content'>
        <div class='propety-card__details'>
          <p>I am a very simple card. I am good at containing small bits of information. I am convenient because I require little markup to use effectively.</p>
          {{> waitingList }}
        </div>
      </div>
    </div>
  </div>
  {{> bookShare }}
  {{> user }}
</template>

<template name='login'>
  {{#if currentUser}}
    <button class='btn btn-primary logout light-blue'>Logout</button>
  {{else}}
    <button class='btn btn-primary btn-facebook light-blue'>Login to enable sharing</button>
  {{/if}}
</template>

<template name='waitingList'>
  <div>
    <ul class="collapsible" data-collapsible="accordion">
    {{ #each waitingList }}
      <div class='row'>
        {{ #each row }}
          <div class='col s12 m12 l4'>
            <div class='property__waiting-list'>
              <li>
                <div class='property__waiting-list-header collapsible-header'>
                  {{ header }}
                  <p>{{ description }}</p>
                  
                  {{ #if hasNotJoined }}
                    <a class="waves-effect waves-teal btn-flat btn-join {{ #unless currentUser }} disabled {{ /unless }}" data-id="{{this._id}}">Join</a>
                  {{ /if }}
                </div>
              </li>
              <div class="collapsible-body"><p>Lorem ipsum dolor sit amet.</p></div>
              <div class='property__waiting-lists'>
                {{ #if isInWaitList this}}
                  {{ #each user_ids }}
                    <div style='color: blue' class="userProfile">
                      <a  href="#!" name="userProfile">{{ name }}</a>
                      <input type="hidden" name="id" value="{{_id}}"/>
                    </div>
                  {{ /each }}
                {{ /if }}
                <div style='color: grey'>+{{ slotsLeft this }} more slots</div>
              </div>
            </div>
          </div>
        {{ /each }}
      </div>
    {{ /each }}
    </ul>
  </div>
  <script>
    $(document).ready(function(){
      console.log('called');
    $('.collapsible').collapsible({
      accordion : false // A setting that changes the collapsible behavior to expandable instead of the default accordion style
    });
  });
  </script>
</template>
